{% extends "core/base.html" %}
{% load static %}

{% block content %}
<div class="container">
    <h2>Análise de Dados Diários</h2>
    <p class="subtitle page-description">Selecione a localização, período e as variáveis climáticas desejadas para uma análise detalhada.</p>

    <form id="daily-analysis-form" class="climad-form">
        {% csrf_token %}
        <fieldset class="form-section">
            <legend>Localização e Período</legend>
            <div class="map-search-wrapper">
                <input type="text" id="map-search-input" placeholder="Pesquisar local ou endereço no mapa...">
                <button type="button" id="map-search-button" class="button-secondary">Pesquisar</button>
            </div>
            <div id="map"></div> 
            <div class="form-grid">
                <div class="input-pair">
                    <div class="form-group"><label for="latitude-input">Latitude</label><input type="text" id="latitude-input" name="latitude" required></div>
                    <div class="form-group"><label for="longitude-input">Longitude</label><input type="text" id="longitude-input" name="longitude" required></div>
                </div>
                <div class="input-pair">
                    <div class="form-group"><label for="start-date-input">Data de Início</label><input type="date" id="start-date-input" name="start_date" required></div>
                    <div class="form-group"><label for="end-date-input">Data de Fim</label><input type="date" id="end-date-input" name="end_date" required></div>
                </div>
            </div>
        </fieldset>
        
        <fieldset class="form-section">
            <legend>Variáveis Climáticas</legend>
            <div class="checkbox-grid">
                <label><input type="checkbox" name="parameters" value="T2M"> Temperatura a 2m</label>
                <label><input type="checkbox" name="parameters" value="T2M_MAX"> Temp. Máx. a 2m</label>
                <label><input type="checkbox" name="parameters" value="T2M_MIN"> Temp. Mín. a 2m</label>
                <label><input type="checkbox" name="parameters" value="RH2M"> Umidade Relativa a 2m</label>
                <label><input type="checkbox" name="parameters" value="PRECTOTCORR"> Precipitação</label>
                <label><input type="checkbox" name="parameters" value="WS10M"> Velocidade do Vento a 10m</label>
                <label><input type="checkbox" name="parameters" value="PS"> Pressão Superficial</label>
                <label><input type="checkbox" name="parameters" value="ALLSKY_SFC_SW_DWN"> Radiação Solar (Céu Aberto)</label>
                <label><input type="checkbox" name="parameters" value="ALLSKY_SFC_LW_DWN"> Radiação Onda Longa (Céu Aberto)</label>
                <label><input type="checkbox" name="parameters" value="CLRSKY_SFC_SW_DWN"> Radiação Solar (Céu Limpo)</label>
            </div>
        </fieldset>

        <button type="submit" class="submit-button">Buscar Dados Diários</button>
        <div class="form-error" style="display: none;"></div>
    </form>

    <div class="results" style="display: none;">
        <h2>Resultados da Análise</h2>
        
        <div class="table-toggle-container">
            <button id="toggle-table-btn" class="button-secondary">Mostrar/Ocultar Tabela de Dados</button>
        </div>
        
        <div id="table-container" style="display: none;">
            <div id="table-wrapper"></div>
        </div>
        
        <div id="charts-container-apex" class="charts-wrapper-apex"></div>
    </div>
</div>
{% endblock %}